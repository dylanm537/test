name: ShipTester
on: 
  workflow_dispatch:
  workflow_call:
  workflow_run:
    workflows: ["Build"]
    types: [completed]
    branches: ["main"]

jobs:
  ship-job:
    permissions:
        actions: read
    runs-on: ubuntu-latest
    steps:      
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Run Docker Container
        run: docker build --tag test .

      - name: Run
        run: docker run -i test

      - name: Get Artifact from Build Workflow
        uses: actions/download-artifact@v4
        with:
          name: go-binary
          run-id: ${{ github.event.workflow_run.id }}
          github-token: ${{ github.token }}
          path: test
    
      - name: Test Artifact
        run: go run test

      - name: Stop containter thing
        run: exit
